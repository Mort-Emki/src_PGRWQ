2025-03-25 15:56:02,387 - INFO - Logging initialized at 2025-03-25 15:56:02
2025-03-25 15:56:02,387 - INFO - Log file: logs\pgrwq_training_20250325_155602.log
2025-03-25 15:56:02,388 - INFO - PG-RWQ Training Pipeline Starting
2025-03-25 15:56:02,388 - INFO - System time: 2025-03-25 15:56:02
2025-03-25 15:56:02,388 - INFO - Python version: 3.9.21 (main, Dec 11 2024, 16:35:24) [MSC v.1929 64 bit (AMD64)]
2025-03-25 15:56:02,388 - INFO - PyTorch version: 2.5.1
2025-03-25 15:56:02,390 - INFO - Started periodic memory monitoring (interval: 30s)
2025-03-25 15:56:02,390 - INFO - [Periodic Check] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.0MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,392 - INFO - Created/verified directory for GPU memory logs: D:\PGRWQ\src_PGRWQ\logs
2025-03-25 15:56:02,392 - INFO - Created GPU memory log file: D:\PGRWQ\src_PGRWQ\logs\gpu_memory_log.csv
2025-03-25 15:56:02,393 - INFO - [Initial GPU Status] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.1MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,393 - INFO - [Setting Working Directory START] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.1MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,396 - INFO - [Setting Working Directory END] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.2MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,396 - INFO - [TIMING] Setting Working Directory completed in 0.00 seconds
2025-03-25 15:56:02,397 - INFO - [Feature Definition START] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.2MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,397 - INFO - [Feature Definition END] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.2MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,398 - INFO - [TIMING] Feature Definition completed in 0.00 seconds
2025-03-25 15:56:02,398 - INFO - 输入特征列表: ['surface_net_solar_radiation_mean', 'surface_pressure_mean', 'temperature_2m_mean', 'u_component_of_wind_10m_mean', 'v_component_of_wind_10m_mean', 'volumetric_soil_water_layer_1_mean', 'volumetric_soil_water_layer_2_mean', 'temperature_2m_min', 'temperature_2m_max', 'total_precipitation_sum', 'potential_evaporation_sum', 'Qout'] (维度: 12)
2025-03-25 15:56:02,398 - INFO - 属性特征列表: ['pre_mm_syr', 'pet_mean', 'aridity', 'seasonality', 'high_prec_freq', 'crp_pc_sse', 'for_pc_sse', 'urb_pc_sse', 'wet_pc_s01', 'nli_ix_sav', 'pop_ct_usu', 'dis_m3_pyr', 'run_mm_syr', 'cly_pc_sav', 'soc_th_sav', 'ele_mt_sav', 'slp_dg_sav', 'sgr_dk_sav', 'moisture_index', 'ero_kh_sav'] (维度: 20)
2025-03-25 15:56:02,399 - INFO - [Device Setup START] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.2MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,399 - INFO - 使用设备：cuda
2025-03-25 15:56:02,399 - INFO - CUDA Device 0: NVIDIA GeForce RTX 3060 Ti
2025-03-25 15:56:02,399 - INFO -   Total Memory: 8.00 GB
2025-03-25 15:56:02,400 - INFO -   CUDA Capability: 8.6
2025-03-25 15:56:02,401 - INFO - [Device Setup END] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.3MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:02,401 - INFO - [TIMING] Device Setup completed in 0.00 seconds
2025-03-25 15:56:02,402 - INFO - [Loading Daily Data START] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 450.3MB | System Memory: 14.3GB / 63.7GB (22.4%)
2025-03-25 15:56:27,737 - INFO - 日尺度数据基本信息：
2025-03-25 15:56:27,737 - INFO -   数据形状: (13325975, 43)
2025-03-25 15:56:27,738 - INFO -   列名: ['date', 'snow_depth_water_equivalent_mean', 'surface_net_solar_radiation_mean', 'surface_net_thermal_radiation_mean', 'surface_pressure_mean', 'temperature_2m_mean', 'dewpoint_temperature_2m_mean', 'u_component_of_wind_10m_mean', 'v_component_of_wind_10m_mean', 'volumetric_soil_water_layer_1_mean', 'volumetric_soil_water_layer_2_mean', 'volumetric_soil_water_layer_3_mean', 'volumetric_soil_water_layer_4_mean', 'snow_depth_water_equivalent_min', 'surface_net_solar_radiation_min', 'surface_net_thermal_radiation_min', 'surface_pressure_min', 'temperature_2m_min', 'dewpoint_temperature_2m_min', 'u_component_of_wind_10m_min', 'v_component_of_wind_10m_min', 'volumetric_soil_water_layer_1_min', 'volumetric_soil_water_layer_2_min', 'volumetric_soil_water_layer_3_min', 'volumetric_soil_water_layer_4_min', 'snow_depth_water_equivalent_max', 'surface_net_solar_radiation_max', 'surface_net_thermal_radiation_max', 'surface_pressure_max', 'temperature_2m_max', 'dewpoint_temperature_2m_max', 'u_component_of_wind_10m_max', 'v_component_of_wind_10m_max', 'volumetric_soil_water_layer_1_max', 'volumetric_soil_water_layer_2_max', 'volumetric_soil_water_layer_3_max', 'volumetric_soil_water_layer_4_max', 'total_precipitation_sum', 'potential_evaporation_sum', 'Qout', 'COMID', 'TP', 'TN']
2025-03-25 15:56:27,747 - INFO - 检查数据中的异常值...
2025-03-25 15:56:28,607 - WARNING - 在列 'Qout' 中发现 207 个负值
2025-03-25 15:56:28,608 - WARNING - 包含负 Qout 值的COMID: [43018325 43023349 43025192 43025193 43025197 43028204 43031122 43031131
 43031333 43031343 43031349 43031365 43031945 43031979 43032102 43034464
 43034574 43034586 43034612 43034700 43034701 43034702 43034703 43034706
 43034707 43034715 43034729 43035269 43035407 43035538 43035565 43035662
 43035839 43035998 43037937 43038309 43038478 43038924 43038950 43039029
 43039140 43039238 43039297 43041492 43041634 43041718 43042096 43042167
 43042329 43045465]
2025-03-25 15:56:28,608 - INFO - 负 Qout 值样例:
2025-03-25 15:56:28,632 - INFO -                date  snow_depth_water_equivalent_mean  surface_net_solar_radiation_mean  surface_net_thermal_radiation_mean  surface_pressure_mean  temperature_2m_mean  dewpoint_temperature_2m_mean  u_component_of_wind_10m_mean  v_component_of_wind_10m_mean  volumetric_soil_water_layer_1_mean  volumetric_soil_water_layer_2_mean  volumetric_soil_water_layer_3_mean  volumetric_soil_water_layer_4_mean  snow_depth_water_equivalent_min  surface_net_solar_radiation_min  surface_net_thermal_radiation_min  surface_pressure_min  temperature_2m_min  dewpoint_temperature_2m_min  u_component_of_wind_10m_min  v_component_of_wind_10m_min  volumetric_soil_water_layer_1_min  volumetric_soil_water_layer_2_min  volumetric_soil_water_layer_3_min  volumetric_soil_water_layer_4_min  snow_depth_water_equivalent_max  surface_net_solar_radiation_max  surface_net_thermal_radiation_max  surface_pressure_max  temperature_2m_max  dewpoint_temperature_2m_max  u_component_of_wind_10m_max  v_component_of_wind_10m_max  volumetric_soil_water_layer_1_max  volumetric_soil_water_layer_2_max  volumetric_soil_water_layer_3_max  volumetric_soil_water_layer_4_max  total_precipitation_sum  potential_evaporation_sum      Qout     COMID  TP  TN
1234896  2019-08-11                               0.0                              8.13                               -5.03                  98.79                23.92                         23.14                         -0.68                         -6.30                                0.43                                0.43                                0.29                                0.16                              0.0                              0.0                              -9.28                 98.32               23.14                        22.34                        -2.48                        -7.87                               0.42                               0.43                               0.21                               0.16                              0.0                            29.93                              -1.06                 99.49               24.79                        23.70                         1.88                        -3.01                               0.43                               0.43                               0.35                               0.16                   220.48                       1.82 -2.088505  43018325 NaN NaN
1236043  2022-10-01                               0.0                             25.35                              -24.04                 100.85                20.95                         18.88                         -1.82                          1.09                                0.28                                0.19                                0.24                                0.23                              0.0                             -0.0                             -65.74                100.53               19.66                        16.51                        -3.44                        -0.83                               0.14                               0.18                               0.24                               0.23                              0.0                           107.71                              -6.47                101.08               21.86                        20.42                        -0.22                         2.64                               0.43                               0.27                               0.24                               0.23                    43.23                       1.52 -0.048182  43018325 NaN NaN
1236044  2022-10-02                               0.0                             67.29                              -19.48                 100.61                22.09                         20.49                          0.49                         -0.22                                0.41                                0.38                                0.24                                0.23                              0.0                             -0.0                             -45.98                100.37               20.49                        19.88                        -1.39                        -1.15                               0.39                               0.32                               0.24                               0.23                              0.0                           275.74                              -5.65                100.77               24.56                        21.44                         2.32                         1.31                               0.43                               0.40                               0.25                               0.23                    35.33                       1.89 -0.076121  43018325 NaN NaN
2584389  2021-07-28                               0.0                             34.39                               -9.86                  99.32                24.07                         21.97                         -2.60                         -5.37                                0.40                                0.34                                0.22                                0.19                              0.0                              0.0                             -22.70                 98.91               23.19                        21.12                        -4.83                        -7.04                               0.29                               0.28                               0.21                               0.19                              0.0                           229.50                              -0.69                 99.55               25.63                        23.60                        -0.99                        -2.83                               0.44                               0.43                               0.24                               0.19                    91.36                       3.93 -0.030214  43023349 NaN NaN
3183840  2021-07-23                               0.0                            153.17                              -34.64                 100.22                26.85                         23.43                         -2.05                         -0.13                                0.35                                0.33                                0.17                                0.19                              0.0                              0.0                             -54.81                100.08               23.61                        22.36                        -2.60                        -0.71                               0.34                               0.33                               0.17                               0.19                              0.0                           524.40                             -15.87                100.35               29.88                        24.57                        -1.56                         0.87                               0.36                               0.34                               0.17                               0.19                     1.11                       5.16 -0.159349  43025192 NaN NaN
2025-03-25 15:56:28,899 - WARNING - 在列 'Qout' 中发现 1810886 个异常值
2025-03-25 15:56:28,899 - WARNING - 包含异常 Qout 值的COMID: [43012449 43012450 43012786 ... 43054880 43054898 43054914]
2025-03-25 15:56:28,900 - INFO - 异常 Qout 值样例:
2025-03-25 15:56:29,203 - INFO -          date  snow_depth_water_equivalent_mean  surface_net_solar_radiation_mean  surface_net_thermal_radiation_mean  surface_pressure_mean  temperature_2m_mean  dewpoint_temperature_2m_mean  u_component_of_wind_10m_mean  v_component_of_wind_10m_mean  volumetric_soil_water_layer_1_mean  volumetric_soil_water_layer_2_mean  volumetric_soil_water_layer_3_mean  volumetric_soil_water_layer_4_mean  snow_depth_water_equivalent_min  surface_net_solar_radiation_min  surface_net_thermal_radiation_min  surface_pressure_min  temperature_2m_min  dewpoint_temperature_2m_min  u_component_of_wind_10m_min  v_component_of_wind_10m_min  volumetric_soil_water_layer_1_min  volumetric_soil_water_layer_2_min  volumetric_soil_water_layer_3_min  volumetric_soil_water_layer_4_min  snow_depth_water_equivalent_max  surface_net_solar_radiation_max  surface_net_thermal_radiation_max  surface_pressure_max  temperature_2m_max  dewpoint_temperature_2m_max  u_component_of_wind_10m_max  v_component_of_wind_10m_max  volumetric_soil_water_layer_1_max  volumetric_soil_water_layer_2_max  volumetric_soil_water_layer_3_max  volumetric_soil_water_layer_4_max  total_precipitation_sum  potential_evaporation_sum       Qout     COMID  TP  TN
0  2019-01-02                              0.06                             94.94                              -92.00                 103.73                -3.87                        -13.54                          0.33                          0.59                                 0.2                                 0.2                                0.22                                0.21                             0.05                              0.0                            -132.13                103.57               -8.17                       -16.95                        -2.17                        -0.48                                0.2                                0.2                               0.22                               0.21                             0.06                           395.19                             -74.54                103.93                1.76                        -9.64                         2.28                         2.06                                0.2                                0.2                               0.22                               0.21                     0.00                       1.41  811.59430  43012449 NaN NaN
1  2019-01-03                              0.05                             95.17                              -85.53                 103.42                -2.04                         -9.42                         -0.51                          1.71                                 0.2                                 0.2                                0.22                                0.21                             0.04                             -0.0                            -126.94                103.24               -6.59                       -12.12                        -2.08                         0.71                                0.2                                0.2                               0.22                               0.21                             0.05                           397.18                             -65.50                103.61                4.50                        -6.69                         1.23                         2.42                                0.2                                0.2                               0.22                               0.21                     0.00                       1.44  801.16266  43012449 NaN NaN
2  2019-01-04                              0.04                             93.19                              -77.16                 103.30                -1.80                         -9.57                          0.62                         -2.61                                 0.2                                 0.2                                0.22                                0.21                             0.04                              0.0                            -118.65                103.15               -5.23                       -12.80                        -0.41                        -4.91                                0.2                                0.2                               0.22                               0.21                             0.04                           394.39                             -29.88                103.47                3.03                        -6.00                         1.37                         0.50                                0.2                                0.2                               0.22                               0.21                     0.00                       2.08  792.04020  43012449 NaN NaN
3  2019-01-05                              0.03                             94.79                              -76.88                 103.24                -1.84                        -10.63                         -0.47                         -1.44                                 0.2                                 0.2                                0.22                                0.21                             0.03                              0.0                            -130.31                103.05               -5.18                       -13.54                        -2.67                        -2.73                                0.2                                0.2                               0.22                               0.21                             0.04                           401.05                             -31.91                103.37                2.17                        -5.45                         1.51                         0.12                                0.2                                0.2                               0.22                               0.21                     0.01                       1.66  784.35120  43012449 NaN NaN
4  2019-01-06                              0.03                             90.19                              -80.29                 103.15                -1.74                         -6.84                         -1.02                          1.47                                 0.2                                 0.2                                0.22                                0.21                             0.03                              0.0                            -109.68                103.01               -5.07                        -9.35                        -2.31                         0.16                                0.2                                0.2                               0.22                               0.21                             0.04                           386.33                             -48.60                103.29                3.02                        -5.56                         0.57                         2.55                                0.2                                0.2                               0.22                               0.21                     0.00                       1.21  777.66644  43012449 NaN NaN
2025-03-25 15:56:29,204 - INFO - 数据异常检测结果摘要:
2025-03-25 15:56:29,204 - INFO -   列 'Qout': 207 个负值, 1810886 个异常值
2025-03-25 15:56:29,360 - INFO - [Checking River Network Consistency START] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 4926.6MB | System Memory: 18.6GB / 63.7GB (29.2%)
2025-03-25 15:56:29,362 - INFO - [Checking River Network Consistency END] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 4926.6MB | System Memory: 18.6GB / 63.7GB (29.2%)
2025-03-25 15:56:29,362 - INFO - [TIMING] Checking River Network Consistency completed in 0.00 seconds
2025-03-25 15:56:29,363 - INFO - [Loading Daily Data END] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 4926.6MB | System Memory: 18.6GB / 63.7GB (29.2%)
2025-03-25 15:56:29,363 - INFO - [TIMING] Loading Daily Data completed in 26.96 seconds
2025-03-25 15:56:29,364 - INFO - [PGRWQ Training Pipeline END] [MEMORY] GPU Memory: 0.0MB / 8191.5MB (0.0%) | Peak: 0.0MB | Process Memory: 4926.6MB | System Memory: 18.6GB / 63.7GB (29.2%)
2025-03-25 15:56:29,364 - INFO - [TIMING] PGRWQ Training Pipeline completed in 26.98 seconds
2025-03-25 15:56:29,364 - ERROR - Error in main execution: local variable 'river_info' referenced before assignment
Traceback (most recent call last):
  File "D:\PGRWQ\src_PGRWQ\main.py", line 410, in <module>
    main()
  File "D:\PGRWQ\src_PGRWQ\main.py", line 310, in main
    river_info,
UnboundLocalError: local variable 'river_info' referenced before assignment
2025-03-25 15:56:29,534 - INFO - Training process completed
